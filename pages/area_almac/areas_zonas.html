<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Áreas y Zonas de Almacén</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../../styles/Area_almac/areas_zonas.css" />
  <script src="../../scripts/area_almac/areas_zonas.js" defer></script>
</head>
<body>
  <div class="warehouse-page container-fluid py-4 px-3 px-md-4">
    <section class="page-header">
      <span class="header-eyebrow">Infraestructura</span>
      <h1 class="header-title">Áreas y zonas de almacén</h1>
      <p class="header-description">
        Diseña el mapa de tu centro logístico con el mismo lenguaje visual del panel administrativo para ubicar áreas, zonas y subniveles con claridad.
      </p>

      <div class="header-highlights">
        <article class="highlight-card">
          <span class="card-label">Áreas activas</span>
          <strong class="card-title" id="totalAreas">0</strong>
          <span class="card-subtitle">Espacios principales definidos</span>
        </article>
        <article class="highlight-card">
          <span class="card-label">Zonas creadas</span>
          <strong class="card-title" id="totalZonas">0</strong>
          <span class="card-subtitle">Segmentos operativos</span>
        </article>
        <article class="highlight-card">
          <span class="card-label">Zonas sin área</span>
          <strong class="card-title" id="zonasSinArea">0</strong>
          <span class="card-subtitle">Pendientes de asignar</span>
        </article>
      </div>
    </section>

    <section class="warehouse-shell">
      <div class="shell-header">
        <div class="shell-header__info">
          <span class="shell-eyebrow">Mapa logístico</span>
          <h2 class="shell-title">Controla ubicaciones y espacios del almacén</h2>
          <p class="shell-subtitle">Registra áreas, zonas y subniveles desde un entorno visual coherente con el resto de herramientas de OptiStock.</p>
        </div>
        <div class="shell-header__actions">
          <button class="shell-action shell-action--primary" onclick="mostrarFormulario('area')">Registrar nueva área</button>
          <button class="shell-action" onclick="mostrarFormulario('zona')">Registrar nueva zona</button>
        </div>
      </div>

      <div class="shell-grid">
        <section class="summary-card" aria-labelledby="resumenPanel">
          <header class="summary-header">
            <span class="summary-eyebrow">Vista general</span>
            <h3 id="resumenPanel" class="summary-title">Resumen del almacén</h3>
            <p class="summary-description">Consulta rápidamente qué áreas existen, sus zonas asociadas y los detalles relevantes de cada una.</p>
          </header>
          <div id="registroLista" class="resumen-contenedor">
            <p class="vacio">No hay áreas ni zonas registradas.</p>
          </div>
        </section>

        <section class="forms-card">
          <div id="error-message" class="form-error" role="alert"></div>

          <form id="areaForm" class="formulario" style="display:none" autocomplete="off">
            <h4>Registrar área de almacén</h4>
            <div class="form-group">
              <label for="areaName">Nombre del área</label>
              <input type="text" name="areaName" id="areaName" placeholder="Nombre del área" required />
            </div>
            <div class="form-group">
              <label for="areaDesc">Descripción</label>
              <textarea id="areaDesc" name="areaDesc" rows="3" placeholder="Uso o características del área" required></textarea>
            </div>
            <div class="form-group">
              <label>Dimensiones físicas (m)</label>
              <div class="dimension-row">
                <input type="number" name="areaWidth" id="areaWidth" placeholder="Ancho" min="0.01" step="0.01" required />
                <input type="number" name="areaHeight" id="areaHeight" placeholder="Alto" min="0.01" step="0.01" required />
                <input type="number" name="areaLength" id="areaLength" placeholder="Largo" min="0.01" step="0.01" required />
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="shell-action shell-action--primary">Guardar área</button>
            </div>
          </form>

          <form id="zoneForm" class="formulario" style="display:none" autocomplete="off">
            <h4>Registrar zona de almacenamiento</h4>
            <div class="form-group">
              <label for="zoneName">Nombre de la zona</label>
              <input type="text" id="zoneName" name="zoneName" placeholder="Nombre de la zona" required />
            </div>
            <div class="form-group">
              <label for="zoneDesc">Descripción</label>
              <textarea id="zoneDesc" name="zoneDesc" rows="3" placeholder="Uso específico o notas" required></textarea>
            </div>
            <div class="form-group">
              <label for="zoneArea">Área asociada</label>
              <select name="zoneArea" id="zoneArea" required>
                <option value="">Seleccione un área</option>
              </select>
            </div>
            <div class="form-group">
              <label>Dimensiones físicas (m)</label>
              <div class="dimension-row">
                <input type="number" id="zoneWidth" name="zoneWidth" placeholder="Ancho" min="0.01" step="0.01" required />
                <input type="number" id="zoneHeight" name="zoneHeight" placeholder="Alto" min="0.01" step="0.01" required />
                <input type="number" id="zoneLength" name="zoneLength" placeholder="Largo" min="0.01" step="0.01" required />
              </div>
            </div>
            <div class="form-group">
              <label for="sublevelsCount">Cantidad de subniveles</label>
              <input type="number" name="sublevelsCount" id="sublevelsCount" min="0" step="1" value="0" />
            </div>
            <div id="sublevelsContainer" class="sublevels-container"></div>
            <div class="form-group">
              <label for="zoneUsage">Ocupación actual (%)</label>
              <input type="number" id="zoneUsage" name="zoneUsage" min="0" max="100" step="0.1" placeholder="Ej. 78" required />
            </div>
            <div class="form-group">
              <label for="zoneProducts">Productos almacenados</label>
              <input type="text" id="zoneProducts" name="zoneProducts" placeholder="Ej. Palets A, Palets B" />
              <small class="form-hint">Separar con comas para registrar múltiples productos.</small>
            </div>
            <div class="form-group">
              <label for="storageType">Tipo de almacenamiento</label>
              <select name="storageType" id="storageType" required>
                <option value="">Seleccione una opción</option>
                <option value="estanteria">Estantería</option>
                <option value="piso">Piso</option>
                <option value="refrigeracion">Refrigeración</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="submit" class="shell-action shell-action--primary">Guardar zona</button>
            </div>
          </form>
        </section>

        <section class="analytics-card">
          <header class="analytics-header">
            <div>
              <span class="analytics-eyebrow">Analítica en vivo</span>
              <h3 class="analytics-title">Seguimiento operativo de áreas y zonas</h3>
              <p class="analytics-description">Filtra la información por nombre, ocupación y productos para identificar oportunidades de optimización.</p>
            </div>
            <div class="export-actions">
              <button class="shell-action" id="exportExcel">Exportar a Excel</button>
              <button class="shell-action" id="exportPDF">Exportar a PDF</button>
            </div>
          </header>

          <div class="analytics-grid">
            <aside class="filters-panel">
              <h4 class="panel-title">Filtros dinámicos</h4>
              <div class="form-group">
                <label for="filterName">Buscar por nombre</label>
                <input type="search" id="filterName" placeholder="Nombre de área o zona" />
              </div>
              <div class="form-group">
                <label for="filterArea">Área asignada</label>
                <select id="filterArea">
                  <option value="">Todas las áreas</option>
                </select>
              </div>
              <div class="form-group">
                <label for="filterCapacity">Capacidad utilizada</label>
                <select id="filterCapacity">
                  <option value="">Todos los rangos</option>
                  <option value="low">Menor al 50%</option>
                  <option value="medium">Entre 50% y 80%</option>
                  <option value="high">Mayor al 80%</option>
                </select>
              </div>
              <div class="form-group">
                <label for="filterProduct">Productos almacenados</label>
                <input type="search" id="filterProduct" placeholder="Nombre del producto" />
              </div>
              <button class="shell-action" id="resetFilters">Restablecer filtros</button>
            </aside>

            <div class="insights-panel">
              <div id="alertsContainer" class="alerts-panel" role="alert"></div>
              <div id="metricsContainer" class="metrics-grid"></div>
              <div class="table-wrapper">
                <table id="tablaAreasZonas">
                  <thead>
                    <tr>
                      <th>Área</th>
                      <th>Zona</th>
                      <th>Tipo</th>
                      <th>Capacidad m³</th>
                      <th>Ocupación</th>
                      <th>Productos</th>
                      <th>Última actualización</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
                <p id="emptyTableMessage" class="vacio" style="display:none">No se encontraron registros con los filtros aplicados.</p>
              </div>
            </div>
          </div>
        </section>
      </div>
    </section>
  </div>
</body>
</html>
